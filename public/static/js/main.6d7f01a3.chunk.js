(this["webpackJsonpcalendar-app"]=this["webpackJsonpcalendar-app"]||[]).push([[0],{133:function(e,t,a){},135:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(7),o=a.n(c),i=a(9),s=a(63),l=a.n(s),u=a(26),m=a(8),d=a(11),p=a.n(d),f=a(16),v=a(18),b=a.n(v),E="https://mern-calendar-g0nza.herokuapp.com/5/api",h=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",n="".concat(E,"/").concat(e);return"GET"===a?fetch(n):fetch(n,{method:a,headers:{"Content-type":"application/json"},body:JSON.stringify(t)})},g=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET",n="".concat(E,"/").concat(e),r=localStorage.getItem("token")||"";return"GET"===a?fetch(n,{method:a,headers:{"x-token":r}}):fetch(n,{method:a,headers:{"Content-type":"application/json","x-token":r},body:JSON.stringify(t)})},O="[UI] Open modal",j="[UI] Close modal",y="[UI] Start loading",w="[UI] Finish loading",k="[EVENT] Set active event",x="[EVENT] Add new",N="[EVENT] Clear active event",_="[EVENT] Update active event",S="[EVENT] Delete active event",I="[EVENT] Events loaded",T="[AUTH] Finish checking login state",C="[AUTH] Login",D="[AUTH] Logout",L=function(){return{type:O}},A=function(){return{type:y}},G=function(){return{type:w}},P=function(e){return{type:C,payload:e}},U=function(){return{type:T}},V=function(){return{type:D}},R=a(15),F=a(36),M=a(4),H=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(n.useState)(e),a=Object(R.a)(t,2),r=a[0],c=a[1],o=Object(n.useCallback)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;c(t)}),[e]),i=function(e){var t=e.target;c(Object(M.a)(Object(M.a)({},r),{},Object(F.a)({},t.name,t.value)))};return[r,i,o]},q=function(e){var t=e.text,a=e.type,n=e.handleInputChange,c=e.value,o=e.name,i=void 0===o?"":o,s=e.i;return r.a.createElement("label",{className:"ui-login__input-item"},t,":",r.a.createElement("div",null,r.a.createElement("input",{className:c&&"ui-login__isWrited",autoComplete:"off",type:a,name:i||t.toLowerCase(),value:c,onChange:function(e){return n(e)},required:!0}),s&&r.a.createElement("i",{className:s})))},z=function(){var e=Object(i.c)((function(e){return e.ui})).isLoading,t=Object(i.b)(),a=H({email:"",password:""}),n=Object(R.a)(a,2),c=n[0],o=n[1];return r.a.createElement("div",{className:"ui-login animate__animated animate__fadeIn"},r.a.createElement("span",{className:"ui-login__title"},"LOGIN"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(function(e){return function(){var t=Object(f.a)(p.a.mark((function t(a){var n,r,c,o,i,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(A()),t.next=3,h("auth",e,"POST");case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,c=r.ok,o=r.name,i=r.token,s=r.id,c?(localStorage.setItem("token",i),localStorage.setItem("token-init-date",(new Date).getTime()),a(P({name:o,uid:s}))):b.a.fire({icon:"error",title:"Error al iniciar sesion",text:"Email o contrase\xf1a incorrectos."}),a(G());case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}(c))}},r.a.createElement("div",{className:"ui-login__input-group"},r.a.createElement(q,{text:"Email",type:"email",handleInputChange:o,value:c.email,i:"fas fa-user"}),r.a.createElement(q,{text:"Password",type:"password",handleInputChange:o,value:c.password,i:"fas fa-envelope"})),r.a.createElement("button",{type:"submit",disabled:e},"LOGIN")))},J=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.ui})).isLoading,a=H({name:"",email:"",password:"",rePassword:""}),n=Object(R.a)(a,2),c=n[0],o=n[1];return r.a.createElement("div",{className:"ui-login animate__animated animate__fadeIn"},r.a.createElement("span",{className:"ui-login__title"},"REGISTER"),r.a.createElement("form",{onSubmit:function(t){if(t.preventDefault(),c.password!==c.rePassword)b.a.fire("Oops","Las contrase\xf1as no coinciden","error");else{var a=c.name,n=c.email,r=c.password;e(function(e){return function(){var t=Object(f.a)(p.a.mark((function t(a){var n,r,c,o,i,s,l;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a(A()),t.next=3,h("auth/register",e,"POST");case 3:return n=t.sent,t.next=6,n.json();case 6:r=t.sent,c=r.ok,o=r.name,i=r.token,s=r.id,l=r.msg,c?(localStorage.setItem("token",i),localStorage.setItem("token-init-date",(new Date).getTime()),a(P({name:o,uid:s})),b.a.fire({icon:"success",title:"Usuario registrado con exito"})):b.a.fire({icon:"error",title:"Error al registrarse",text:l}),a(G());case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}({name:a,email:n,password:r}))}}},r.a.createElement("div",{className:"ui-login__input-group"},r.a.createElement(q,{text:"Nombre",name:"name",type:"text",handleInputChange:o,value:c.name,i:"fas fa-user-circle"}),r.a.createElement(q,{text:"Email",type:"email",handleInputChange:o,value:c.email,i:"fas fa-envelope"}),r.a.createElement(q,{text:"Contrase\xf1a",name:"password",type:"password",handleInputChange:o,value:c.password,i:"fas fa-key"}),r.a.createElement(q,{text:"Repita la contrase\xf1a",name:"rePassword",type:"password",handleInputChange:o,value:c.rePassword,i:"fas fa-key"})),r.a.createElement("button",{type:"submit",disabled:t},"REGISTRAR")))},B=function(){return r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/auth/login",component:z}),r.a.createElement(m.b,{exact:!0,path:"/auth/register",component:J}),r.a.createElement(m.a,{to:"/auth/login"}))},X=function(){return r.a.createElement("div",{className:"auth-screen"},r.a.createElement(B,null))},W=function(e){var t=e.urlImage,a=Object(i.c)((function(e){return e.auth})).name,n=Object(i.b)();return r.a.createElement("nav",{className:"navbar"},r.a.createElement("div",{className:"navbar__profile"},r.a.createElement("div",null,r.a.createElement("img",{src:t,alt:"Profile"})),r.a.createElement("p",null,a)),r.a.createElement("div",{onClick:function(){n(function(){var e=Object(f.a)(p.a.mark((function e(t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:localStorage.clear(),t(V());case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},className:"navbar__sign-out"},r.a.createElement("i",{className:"fas fa-sign-out-alt"})))},K=function(e){var t=e.event,a=t.title,n=t.user;return r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("strong",{style:{whiteSpace:"pre-wrap"}},a),r.a.createElement("p",null," - ",n.name))},Q=a(50),Y=a.n(Q),Z=a(51),$=a.n(Z),ee=a(22),te=a.n(ee),ae=function(e){return{type:I,payload:e}},ne=function(e){return{type:x,payload:e}},re=function(){return{type:N}},ce=function(e){return{type:_,payload:e}},oe=function(e){return{type:S,payload:e}};Y.a.setAppElement("#root");var ie=te()().minutes(0).seconds(0).add(1,"hours"),se=te()().minutes(0).seconds(0).add(2,"hours"),le={title:"",notes:"",start:ie.toDate(),end:se.toDate()},ue=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e})),a=t.ui,c=t.calendar,o=H(le),s=Object(R.a)(o,3),l=s[0],u=s[1],m=s[2],d=l.title,v=l.notes,E=l.start,h=l.end,O=a.modalOpen,y=c.activeEvent;Object(n.useEffect)((function(){y&&m(y)}),[y,m]);var w=function(){e(re()),e({type:j}),m()};return r.a.createElement(Y.a,{isOpen:O,onRequestClose:w,contentLabel:"Example Modal",overlayClassName:"modal-fondo",className:"animate__animated animate__backInDown modal",closeTimeoutMS:999},r.a.createElement("h1",null," Nuevo evento "),r.a.createElement("hr",null),r.a.createElement("form",{className:"container",onSubmit:function(t){var a;t.preventDefault(),e(y?(a=Object(M.a)(Object(M.a)({},y),l),function(){var e=Object(f.a)(p.a.mark((function e(t){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("events/".concat(a.id),a,"PUT");case 2:return n=e.sent,e.next=5,n.json();case 5:(r=e.sent).ok?t(ce(a)):b.a.fire("Oops...",r.msg,"error");case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()):function(e){return function(){var t=Object(f.a)(p.a.mark((function t(a,n){var r,c,o,i,s;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=n().auth,c=r.name,o=r.uid,t.prev=1,t.next=4,g("events",e,"POST");case 4:return i=t.sent,t.next=7,i.json();case 7:(s=t.sent).ok&&(e.id=s.evento.id,e.user={_id:o,name:c},a(ne(e))),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(1),console.log(t.t0);case 14:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e,a){return t.apply(this,arguments)}}()}(l)),w()}},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Fecha y hora inicio"),r.a.createElement($.a,{onChange:function(e){return u({target:{value:e,name:"start"}})},value:E})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Fecha y hora fin"),r.a.createElement($.a,{onChange:function(e){return u({target:{value:e,name:"end"}})},value:h,minDate:E})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,"Titulo y notas"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"T\xedtulo del evento",name:"title",autoComplete:"off",value:d,onChange:u})),r.a.createElement("div",{className:"form-group"},r.a.createElement("textarea",{type:"text",className:"form-control",placeholder:"Notas",rows:"5",name:"notes",value:v,onChange:u})),r.a.createElement("button",{type:"submit",className:"btn btn-outline-primary btn-block"},r.a.createElement("i",{className:"far fa-save"}),r.a.createElement("span",null," Guardar"))))},me=(a(131),a(53)),de=(a(132),{allDay:"Todo el d\xeda",previous:"<",next:">",today:"Hoy",month:"Mes",week:"Semana",day:"D\xeda",agenda:"Agenda",date:"Fecha",time:"Hora",event:"Evento",noEventsInRange:"No hay eventos en este rango",showMore:function(e){return"+ Ver m\xe1s (".concat(e,")")}});te.a.locale("es");var pe=Object(me.b)(te.a),fe={urlImage:"https://avatars1.githubusercontent.com/u/66537765?s=460&u=23c939f2f6ef1d8733094b61abd9ed57b4b6de20&v=4",name:"Gonzalo Flores"},ve=function(){var e=Object(i.b)(),t=Object(i.c)((function(e){return e.calendar})),a=t.events,c=t.activeEvent,o=Object(i.c)((function(e){return e.auth})).uid,s=Object(n.useState)(localStorage.getItem("lastView")||"month"),l=Object(R.a)(s,2),u=l[0],m=l[1];Object(n.useEffect)((function(){e(function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("events/");case 2:return a=e.sent,e.next=5,a.json();case 5:(n=e.sent).ok&&t(ae(n.eventos));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[e]);return r.a.createElement("div",{className:"calendar-screen"},r.a.createElement(W,fe),r.a.createElement("div",{className:"calendar-screen__container"},r.a.createElement(me.a,{localizer:pe,events:a,startAccessor:"start",endAccessor:"end",messages:de,eventPropGetter:function(e,t,a,n){return{style:{backgroundColor:e.user._id===o?"#3498db":"#465660",borderRadius:"0px",opacity:.8,color:"white"}}},onSelectEvent:function(t){e({type:k,payload:t})},onDoubleClickEvent:function(t){e(L())},view:u,onView:function(e){m(e),localStorage.setItem("lastView",e)},components:{event:K},onSelectSlot:function(t){e(re());var a=t.start,n=t.end;e(ne({start:a,end:n,title:"Modifique el titulo",notes:"Modifique las notas",id:(new Date).getTime(),user:{name:"Gonzalo",_id:123154124}}))},selectable:!0})),r.a.createElement(ue,null),r.a.createElement("button",{className:"calendar-screen__add-event",onClick:function(){e(L())}},"+"),r.a.createElement("button",{className:"calendar-screen__delete-event",style:{opacity:c?"1":"0"},onClick:function(){var t;e((t=c.id,function(){var e=Object(f.a)(p.a.mark((function e(a){var n,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("events/".concat(t),{},"DELETE");case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent;try{r.ok?a(oe(t)):b.a.fire("Oops...",r.msg,"error")}catch(c){console.log(c)}case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()))}},r.a.createElement("i",{className:"far fa-trash-alt"})))},be=a(39),Ee=function(e){var t=e.isAuth,a=e.component,n=Object(be.a)(e,["isAuth","component"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return t?r.a.createElement(a,e):r.a.createElement(m.a,{to:"/auth/login"})}}))},he=function(e){var t=e.isAuth,a=e.component,n=Object(be.a)(e,["isAuth","component"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return t?r.a.createElement(m.a,{to:"/"}):r.a.createElement(a,e)}}))},ge=function(){var e=Object(i.c)((function(e){return e.auth})),t=e.isLoged,a=e.checking,c=Object(i.b)();return Object(n.useEffect)((function(){c(function(){var e=Object(f.a)(p.a.mark((function e(t){var a,n,r,c,o,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g("auth/renew",{});case 2:return a=e.sent,e.next=5,a.json();case 5:n=e.sent,r=n.ok,c=n.token,o=n.name,i=n.uid,r?(localStorage.setItem("token",c),localStorage.setItem("token-init-date",(new Date).getTime()),t(P({name:o,uid:i}))):t(U());case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[c]),a?r.a.createElement("div",{className:"loader"},r.a.createElement(l.a,{type:"TailSpin",color:"#00BFFF",height:100,width:100})):r.a.createElement(u.a,null,r.a.createElement(m.d,null,r.a.createElement(he,{isAuth:t,path:"/auth",component:X}),r.a.createElement(Ee,{isAuth:t,path:"/",component:ve})))},Oe=a(23),je=a(66),ye=a(54),we="undefined"!==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||Oe.d,ke=Object(Oe.c)({ui:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{modalOpen:!1,isLoading:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return Object(M.a)(Object(M.a)({},e),{},{modalOpen:!1});case O:return Object(M.a)(Object(M.a)({},e),{},{modalOpen:!0});case y:return Object(M.a)(Object(M.a)({},e),{},{isLoading:!0});case w:return Object(M.a)(Object(M.a)({},e),{},{isLoading:!1});default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{checking:!0,isLoged:!1},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(M.a)(Object(M.a)(Object(M.a)({},e),t.payload),{},{checking:!1,isLoged:!0});case T:return Object(M.a)(Object(M.a)({},e),{},{checking:!1});case D:return{checking:!1,isLoged:!1};default:return e}},calendar:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{events:[],activeEvent:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return Object(M.a)(Object(M.a)({},e),{},{activeEvent:t.payload});case x:return Object(M.a)(Object(M.a)({},e),{},{events:[].concat(Object(ye.a)(e.events),[t.payload])});case N:return Object(M.a)(Object(M.a)({},e),{},{activeEvent:null});case _:return Object(M.a)(Object(M.a)({},e),{},{events:e.events.map((function(e){return e.id===t.payload.id?t.payload:e}))});case S:return Object(M.a)(Object(M.a)({},e),{},{events:e.events.reduce((function(e,a){return a.id===t.payload?e:[].concat(Object(ye.a)(e),[a])}),[])});case I:return Object(M.a)(Object(M.a)({},e),{},{events:t.payload.map((function(e){return Object(M.a)(Object(M.a)({},e),{},{start:new Date(e.start),end:new Date(e.end)})}))});default:return e}}}),xe=Object(Oe.e)(ke,we(Object(Oe.a)(je.a))),Ne=function(){return r.a.createElement(i.a,{store:xe},r.a.createElement(ge,null))};a(133);o.a.render(r.a.createElement(Ne,null),document.getElementById("root"))},67:function(e,t,a){e.exports=a(135)}},[[67,1,2]]]);
//# sourceMappingURL=main.6d7f01a3.chunk.js.map